<!doctype html><html lang="ko" data-mode="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Components - Data Plane(Node) Kubernetes Deep Dive - 3" /><meta name="author" content="KanghoonYi(pour)" /><meta property="og:locale" content="ko" /><meta name="description" content="이번에는 Kubernetes에서 사용자의 Application이 돌아가는 ‘Data Plane(Node)’에서, Kubernetes 시스템을 위해 돌아가는 컴포넌트(Components)들을 알아보고자 합니다." /><meta property="og:description" content="이번에는 Kubernetes에서 사용자의 Application이 돌아가는 ‘Data Plane(Node)’에서, Kubernetes 시스템을 위해 돌아가는 컴포넌트(Components)들을 알아보고자 합니다." /><link rel="canonical" href="https://blog.devpour.net/posts/k8s-data-plane/" /><meta property="og:url" content="https://blog.devpour.net/posts/k8s-data-plane/" /><meta property="og:site_name" content="KanghoonYi(Pour)" /><meta property="og:image" content="https://blog.devpour.net/assets/img/for-post/k8s%20data%20plane/k8s-data-plane-cover.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-07-04T21:35:00+09:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://blog.devpour.net/assets/img/for-post/k8s%20data%20plane/k8s-data-plane-cover.jpg" /><meta property="twitter:title" content="Components - Data Plane(Node) Kubernetes Deep Dive - 3" /><meta name="google-site-verification" content="rsx_-5MJzSR_3NNCqHNe9IxnKJxlD8Eid8_wN8e9c1I" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"KanghoonYi(pour)","url":"https://www.linkedin.com/in/pour/"},"dateModified":"2025-07-10T18:06:59+09:00","datePublished":"2025-07-04T21:35:00+09:00","description":"이번에는 Kubernetes에서 사용자의 Application이 돌아가는 ‘Data Plane(Node)’에서, Kubernetes 시스템을 위해 돌아가는 컴포넌트(Components)들을 알아보고자 합니다.","headline":"Components - Data Plane(Node) Kubernetes Deep Dive - 3","image":"https://blog.devpour.net/assets/img/for-post/k8s%20data%20plane/k8s-data-plane-cover.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.devpour.net/posts/k8s-data-plane/"},"url":"https://blog.devpour.net/posts/k8s-data-plane/"}</script><title>Components - Data Plane(Node) | Kubernetes Deep Dive - 3 | KanghoonYi(Pour)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="KanghoonYi(Pour)"><meta name="application-name" content="KanghoonYi(Pour)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/pour_profile_img.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">KanghoonYi(Pour)</a></h1><p class="site-subtitle fst-italic mb-0">안녕하세요~ Software Engineer pour입니다 This is Pour.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/KanghoonYi" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['rkdgnsdls','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Components - Data Plane(Node) | Kubernetes Deep Dive - 3</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Components - Data Plane(Node) | Kubernetes Deep Dive - 3</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1751632500" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jul 4, 2025 </time> </span> <span> Updated <time data-ts="1752138419" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jul 10, 2025 </time> </span><div class="mt-3 mb-3"> <a href="/assets/img/for-post/k8s%20data%20plane/k8s-data-plane-cover.jpg" class="popup img-link preview-img shimmer"><img src="/assets/img/for-post/k8s%20data%20plane/k8s-data-plane-cover.jpg" alt="Preview Image" width="1200" height="630" loading="lazy"></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.linkedin.com/in/pour/">KanghoonYi(pour)</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="5056 words" > <em>28 min</em> read</span></div></div></div></header><div class="content"><p>이번에는 Kubernetes에서 사용자의 Application이 돌아가는 ‘Data Plane(Node)’에서, Kubernetes 시스템을 위해 돌아가는 컴포넌트(Components)들을 알아보고자 합니다.</p><p><a href="/assets/img/for-post/k8s%20data%20plane/image.png" class="popup img-link w-50 shimmer"><img src="/assets/img/for-post/k8s%20data%20plane/image.png" alt="Node와 Node의 컴포넌트들" loading="lazy"></a> <em>Node와 Node의 컴포넌트들</em></p><h2 id="node에-대해서"><span class="me-2">Node에 대해서</span><a href="#node에-대해서" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>컴포넌트들에 대해 이해하기에 앞서, Kubernetes에서 Node의 의미를 짚고 가고자 합니다.<br /> Kubernetes에서 ‘Node’는, 사용자의 Pod(container로 이루어진)이 실제로 돌아가는 머신(machine)을 의미합니다.<br /> 이 머신은, VM(Virtual Machine, virtualbox와 같은)일수도 있고, 물리(physical) 머신일 수도 있습니다.</p><blockquote class="prompt-info"><p>Kubernetes에서 Node로서 머신을 인식하기 위해서는, Network interface와 함께, ‘kubelet’이라는 컴포넌트가 중요한 역할을 합니다. 즉, OS자체라기 보다는 OS위에서 구동되는 kubelet이 중요합니다.</p></blockquote><p>이 Node에는 Kubernetes의 구성요소로서 역할하기 위해, 필수적(necessary)으로 필요한 서비스(컴포넌트)들을 포함하고 있습니다.(뒤에 나올 kubelet과 같은 컴포넌트들을 말합니다)<br /> 이 컴포넌트들을 통해, ‘Control Plane’과 계속 통신하며 Node로서의 지위를 유지하고, Pod이 실제로 Node위에서 동작(run)하기 위한 일련의 과정을 수행합니다.</p><h3 id="node-관리하기추가하기"><span class="me-2">Node 관리하기(추가하기)</span><a href="#node-관리하기추가하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>노드를 kubernetes 클러스터(cluster)에 등록하기 위해, 주로 2가지 방법을 사용합니다.</p><h4 id="노드-스스로-control-plane에-등록하는-방법self-registration-of-nodes"><span class="me-2"><a href="https://kubernetes.io/docs/concepts/architecture/nodes/#self-registration-of-nodes">노드 스스로 Control plane에 등록하는 방법(Self-registration of Nodes)</a></span><a href="#노드-스스로-control-plane에-등록하는-방법self-registration-of-nodes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>노드를 관리하는 ‘kubelet’의 Flag중 <code class="language-plaintext highlighter-rouge">--register-node</code> 가 <code class="language-plaintext highlighter-rouge">true</code>(default값이 true) 라면, ‘kubelet’이 스스로 API Server를 통해 자신의 노드를 등록합니다.</p><h4 id="사용자가-수동으로-직접-node-object를-생성하는-방법"><span class="me-2"><a href="https://kubernetes.io/docs/concepts/architecture/nodes/#manual-node-administration">사용자가 수동으로 직접 ‘Node Object’를 생성하는 방법</a></span><a href="#사용자가-수동으로-직접-node-object를-생성하는-방법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Kubernetes를 조작하기 위한 Client인 <code class="language-plaintext highlighter-rouge">kubectl</code>을 통해, Node Object를 수동으로 생성할 수 있습니다.<br /> 만약 Node를 수동으로 등록하고자 한다면, ‘kubelet’의 <code class="language-plaintext highlighter-rouge">--register-node=false</code> 로 설정해야 합니다.</p><blockquote class="prompt-info"><p>노드를 등록하는 과정에서, 노드의 이름을 유니크(unique)하게 관리하는게 중요합니다.<br /> Cluster에서는, 노드의 이름이 동일하다면, 동일한 ‘Node Object’로 인식합니다.<br /> 이 부분을 주의하지 않으면, 이름이 동일한 다른 머신으로 인해 Cluster의 장애를 유발할 수 있습니다.</p></blockquote><h2 id="kubelet"><span class="me-2">kubelet</span><a href="#kubelet" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/assets/img/for-post/k8s%20data%20plane/image%201.png" class="popup img-link w-50 shimmer"><img src="/assets/img/for-post/k8s%20data%20plane/image%201.png" alt="image.png" loading="lazy"></a></p><p>‘kubelet’은 Node에서 돌아가는 Agent(사용자를 대신하여 자율적으로 작업을 수행하는 소프트웨어)입니다.<br /> ‘Pod’안에 있는 container들이 계속해서 동작하도록(running상태 이도록) 하며, <strong>노드를 운영하는 핵심적인 역할</strong>을 수행합니다.</p><blockquote class="prompt-info"><p>kubelet은 kubernetes를 통해 생성된 container만 관리합니다.<br /> container의 label / tag를 이용하여, cluster에 있는 container인지 구분합니다.<br /> (해당 머신에 접속하면, kubelet과 공유하는 Container runtime을 통해 다른 container를 실행할 수 있습니다)</p></blockquote><p>kubelet이 노드에서 하는 역할은 아래와 같습니다.</p><h3 id="podspec을-동기화-합니다"><span class="me-2">PodSpec을 동기화 합니다.</span><a href="#podspec을-동기화-합니다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>‘kubelet’은 API Server(kube-api-server)로 부터 자신의 노드에 할당된 PodSpec을 계속 감시합니다.<br /> Pod에 변경사항(생성되거나 수정됨)이 있다면, 노드의 Container Runtime을 통해 container를 실행하거나 종료합니다.<br /> 아래는, PodSpec의 예시입니다.</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Pod</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">my-pod</span>
<span class="na">spec</span><span class="pi">:</span>            <span class="c1"># PodSpec</span>
  <span class="na">containers</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">web</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">nginx:1.25.0</span>
    <span class="na">ports</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">80</span>
  <span class="na">restartPolicy</span><span class="pi">:</span> <span class="s">Always</span>
  <span class="na">nodeSelector</span><span class="pi">:</span>
    <span class="na">disktype</span><span class="pi">:</span> <span class="s">ssd</span>
  <span class="na">volumes</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">config</span>
    <span class="na">configMap</span><span class="pi">:</span>
      <span class="na">name</span><span class="pi">:</span> <span class="s">web-config</span>
</pre></table></code></div></div><h3 id="컨테이너-런타임-인터페이스container-runtime-interface-cri과-연동되어-작동합니다"><span class="me-2">컨테이너 런타임 인터페이스(Container Runtime Interface, CRI)과 연동되어 작동합니다.</span><a href="#컨테이너-런타임-인터페이스container-runtime-interface-cri과-연동되어-작동합니다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>여러 컨테이너 런타임(Docker, containerd, CRI-O)에 호환성이 있어, gRPC를 통해 컨테이터 런타임을 작동시킵니다.<br /> 컨테이너 런타임을 통해, 외부에서 이미지를 가져오거나(pull), container를 생성, 삭제하며, 메트릭과 로그를 수집합니다.</p><h3 id="상태-보고status-reporting"><span class="me-2">상태 보고(Status Reporting)</span><a href="#상태-보고status-reporting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>‘kubelet’은 Node(노드)와 Pod(파드)의 상태를 실시간으로 파악하여 보고합니다. 이러한 보고는, ‘kube-apiserver’를 통해, etcd에 최종 기록됩니다.</p><h4 id="node-상태-보고"><span class="me-2">Node 상태 보고</span><a href="#node-상태-보고" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p>capacity / allocatable<br /> CPU, 메모리, 디스크와 같은 리소스 할당량 및 한계량을 API Server를 통해 Control Plane에 보고합니다.</p><li><p>Node의 현재상태<br /> Ready(Node가 Pod을 받을 수 있는 상태)인지,<br /> DiskPressure, MemoryPressure, PIDPressure와 같은 리소스 압박 상태인지<br /> NetworkUnavailable과 같이 네트워크 문제가 있는지<br /> 확인하여 보고합니다.</p><li><p>Internal IP, Hostname, External IP등의 address를 보고합니다.</p><li><p>Node에서 돌아가는 daemon의 endpoints(daemonEndpoints)를 보고합니다.<br /> kubelet과 같은 Daemon에 대한 포트(port)정보를 보고합니다.</p><blockquote class="prompt-info"><p>이 Port정보는, Control plane과 통신하기 위한 gRPC와 HTTPS 포트입니다.</p></blockquote><blockquote class="prompt-info"><p>과거에는 dockershim에 대한 정보도 함께 공유됬지만, dockershim이 deprecated되면서 제거되었습니다.</p></blockquote></ul><h4 id="pod-상태-보고"><span class="me-2">Pod 상태 보고</span><a href="#pod-상태-보고" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><p><a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#pod-phase">Pod의 phase</a>를 보고합니다.<br /> ‘phase’는 Pod의 ‘상태’를 말합니다. 다만, status와 다른것은, Pod Lifecycle로 추상화된 ‘high-level summary’입니다.<br /> ‘Pending’, ‘Running’, ‘Succeeded’, ‘Failed’, ‘Unknown’과 같은 값이 있습니다.</p><li><p><a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#pod-conditions">Pod의 Conditions</a>를 보고합니다.<br /> Pod은 ‘PodStatus’를 가지는데, 이는 여러 condition으로 이루어져 있습니다.<br /> ‘PodScheduled’, ‘PodReadyToStartContainers’, ‘Ready’등의 값이 있습니다.</p><li><p>Pod에 포함된 Container상태 보고<br /> Pod의 Container상태를 보고합니다.<br /> ready, restartCount(재시작 횟수), state와 함께, 상세사유를 보고합니다.</p><li>Host IP와 Pod IP를 보고합니다.<li>startTime을 보고합니다.</ul><h3 id="pod에-대한-헬스체크-및-라이프사이클lifecycle-관리"><span class="me-2">Pod에 대한 헬스체크 및 라이프사이클(Lifecycle) 관리</span><a href="#pod에-대한-헬스체크-및-라이프사이클lifecycle-관리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>‘kubelet’은 Pod의 현재상태를 체크하며, 라이프 사이클에 따라 적당한 작업을 수행합니다.</p><h4 id="pod-상태-확인"><span class="me-2">Pod 상태 확인</span><a href="#pod-상태-확인" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>개별 Container에 대한, ‘Liveness’, ‘Readiness’, ‘Startup Probe’를 실행해 헬스(health) 상태를 판단합니다.</p><h4 id="lifecycle-관리"><span class="me-2">Lifecycle 관리</span><a href="#lifecycle-관리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>실패한 Container를 재시작하거나, Ready상태를 해제해, 서비스 트래픽에서 제외시킵니다.</p><h3 id="볼륨-마운트-관리"><span class="me-2">볼륨 마운트 관리</span><a href="#볼륨-마운트-관리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Pod에 정의된 PV(PersistentVolume), ConfigMap, Secret 볼륨을 마운트(mount)하거나 언마운트(unmount) 합니다.</p><h3 id="노트-상태-관리"><span class="me-2">노트 상태 관리</span><a href="#노트-상태-관리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>노드의 리소스 사용량(CPU, 메모리, 디스크)과 헬스(Ready/NotReady)를 판단해 API Server에 보고합니다.<br /> 리소스 부족 시에는 evict(축출) 정책을 실행합니다.</p><h3 id="kubelet의-구성요소"><span class="me-2">kubelet의 구성요소</span><a href="#kubelet의-구성요소" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>Pod Manager<br /> PodSpec을 해석하여, runtime 명령어로 변환하고 실행합니다.</p><li><p>Probe Manager<br /> Liveness / Readiness / Startup Probe 을 스케쥴링 하고 실행합니다.</p><li>Volume Manager<br /> CSI(Container Storage Interface) 플러그인을 연동하고, 볼륨을 마운트 / 언마운트 합니다.<blockquote class="prompt-info"><p>CSI(Container Storage Interface):<br /> Container Runtime을 위한 Storage Interface를 말 합니다.<br /> AWS나 GCP와 같이 kubernetes환경마다 다양한 storage를 지원하기 때문에, 이런 다양한 storage를 지원하기 위해 만들어진 interface입니다.</p></blockquote><li><p>Eviction Manager<br /> Node의 자원(CPU, RAM, Disk 같은) 압박(pressure) 상황에서 Pod을 축출(eviction)합니다</p><li>Status Manager<br /> API Server를 통해 Pod/Node의 상태를 업데이트 합니다.</ul><h3 id="확장-가능한-부분"><span class="me-2">확장 가능한 부분</span><a href="#확장-가능한-부분" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>Device Plugins<br /> GPU, FPGA와 같은 특수 하드웨어 리소스를 할당하기 위해 별도의 플러그인을 설치할 수 있습니다.</p><li>Custom Metrics Adapter<br /> Application의 메트릭을 Pod레벨로 노출시켜 사용할 수 있게 합니다.<blockquote class="prompt-info"><p>‘Prometheus Adapter(커스텀 메트릭 어댑터)’를 통해, App에서 제공하는 메트릭을 HPA(Horizontal Pod Autoscaler)가 참조하도록 할 수 있습니다.</p></blockquote><li>Static Pods<br /> Node에서 직접 정의된 YAML로 노드수준의 kubelet이 직접 관리하는 Pod입니다. 즉 API Server없이 실행되는 Pod입니다.</ul><h2 id="kube-proxy"><span class="me-2">kube-proxy</span><a href="#kube-proxy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="/assets/img/for-post/k8s%20data%20plane/image%202.png" class="popup img-link shimmer"><img src="/assets/img/for-post/k8s%20data%20plane/image%202.png" alt="kube-proxy와 Service의 machanism" loading="lazy"></a> <em>kube-proxy와 Service의 machanism</em></p><dl><dt>‘kube-proxy’는<dd>각각의 Node에서 작동하는 network proxy 입니다.<dd>Kubernetes의 ‘Service’라는 추상화된 컨셉을 적용하기 위한 컨포턴트 입니다.<dd>Node의 network rule을 관리하며, 이를 통해 Pod이 Cluster내부/외부 모두 통신할 수 있게 해줍니다.</dl><p>만약 OS에서 ‘Packet filtering layer’가 있다면 해당 기능을 사용하고, 그렇지 않으면 ‘kube-proxy’가 직접 그 역할을 수행합니다(Golang 기반의 App).</p><blockquote class="prompt-info"><p>리눅스 커널에는 Netfilter(iptables)나 IPVS 같은 ‘Packet filtering / routing’ 기능을 포함하고 있습니다. 이를 이용할 수 있으면, ‘kube-proxy’의 packet 처리 기능을 커널레벨에서 처리하므로, 매우 빠르게(CPU효율적으로) 처리할 수 있습니다.</p></blockquote><h3 id="주요-역할"><span class="me-2">주요 역할</span><a href="#주요-역할" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>Service IP와 Pod IP를 매핑(mapping)합니다.<br /> Kubernetes의 ‘Service’에 할당된 ClusterIP(Cluster수준에서 사용되는 가상 IP)를 통해 traffic을 받으면, 이를 개별 Pod으로 포워딩 해줍니다.</p><li><p>Load-balancing(부하 분산)을 수행합니다.<br /> ‘kube-proxy’가 작동하는 ‘모드’에 따라, 다른 balancing이 이루어 집니다.</p><li><p>노드 간 / 노드 밖에 대한 트래픽을 라우팅 합니다.</p></ul><h3 id="동작-모드"><span class="me-2">동작 모드</span><a href="#동작-모드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>‘kube-proxy’는 크게 2가지의 모드로 구분됩니다.</p><blockquote class="prompt-info"><p>kube-proxy는 Host의 OS에 따라, 사용할 수 있는 mode가 제한됩니다.</p></blockquote><h4 id="iptables-모드default설정"><span class="me-2">ipTables 모드(default설정)</span><a href="#iptables-모드default설정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><a href="/assets/img/for-post/k8s%20data%20plane/image%203.png" class="popup img-link shimmer"><img src="/assets/img/for-post/k8s%20data%20plane/image%203.png" alt="ipTables Rule을 통해 보는, LB부터 Pod에 이르는 packet flow - from [cncf.io](https://www.cncf.io/blog/2020/01/30/kubernetes-networking-demystified-a-brief-guide/)" loading="lazy"></a> <em>ipTables Rule을 통해 보는, LB부터 Pod에 이르는 packet flow - from <a href="https://www.cncf.io/blog/2020/01/30/kubernetes-networking-demystified-a-brief-guide/">cncf.io</a></em></p><p>‘Service’생성 시에, ‘서비스에 대한 ClusterIP + 포트’ 조합에 대해 iptables 체인을 설정합니다.<br /> 노드의 커널 레벨에서, ‘서비스의 ClusterIP + Port’로 들어오는 패킷을 RR(Round Robin) 방식으로 뒷단의 Pod IP로 리다이렉트 합니다.</p><dl><dt>장점은<dd>커널 레벨에서 처리하기 때문에, 높은 성능을 제공하므로, 낮은 지연시간을 보여줍니다.<dt>단점은<dd>규칙 수가 너무 많아지면 iptables 룰 체인이 커져서, 관리 오버헤드가 발생합니다.</dl><p>아래는, ‘iptables’에서 ‘my-service’라는 ClusterIP서비스(<code class="language-plaintext highlighter-rouge">10.96.0.10:80</code>)가 2개의 백엔드 Pod(<code class="language-plaintext highlighter-rouge">192.168.1.11:8080</code>, <code class="language-plaintext highlighter-rouge">192.168.1.12:8080</code>)로 트래픽을 분산하는 Rule의 모습을 보여줍니다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span>iptables <span class="nt">-t</span> nat <span class="nt">-L</span> KUBE-SERVICES <span class="nt">-n</span> <span class="nt">--line-numbers</span>
Chain KUBE-SERVICES <span class="o">(</span>2 references<span class="o">)</span>
num  target     prot opt <span class="nb">source               </span>destination
1    KUBE-SEP-ABCDEF123456  tcp  <span class="nt">--</span>  0.0.0.0/0            10.96.0.10           /<span class="k">*</span> default/my-service: cluster IP <span class="k">*</span>/ tcp dpt:80
2    KUBE-MARK-MASQ       all  <span class="nt">--</span>  0.0.0.0/0            10.96.0.10           /<span class="k">*</span> default/my-service: cluster IP <span class="k">*</span>/ 
3    RETURN               all  <span class="nt">--</span>  0.0.0.0/0            0.0.0.0/0
</pre></table></code></div></div><ul><li><strong>1번 룰</strong>: Service IP(10.96.0.10:80, Cluster IP) 로 들어오는 TCP 패킷을 KUBE-SEP-ABCDEF123456 체인으로 점프시킵니다.<li><strong>2번 룰</strong>: SNAT(소스 마스커레이드) 표시를 위해 KUBE-MARK-MASQ 체인으로 점프.<li><strong>3번 RETURN</strong>: 더 이상 매칭되지 않으면 원래 체인으로 복귀.</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span>iptables <span class="nt">-t</span> nat <span class="nt">-L</span> KUBE-SEP-ABCDEF123456 <span class="nt">-n</span> <span class="nt">--line-numbers</span>
Chain KUBE-SEP-ABCDEF123456 <span class="o">(</span>1 references<span class="o">)</span>
num  target     prot opt <span class="nb">source               </span>destination
1    DNAT       tcp  <span class="nt">--</span>  0.0.0.0/0            192.168.1.11        /<span class="k">*</span> default/my-service <span class="k">*</span>/ tcp dpt:8080
2    DNAT       tcp  <span class="nt">--</span>  0.0.0.0/0            192.168.1.12        /<span class="k">*</span> default/my-service <span class="k">*</span>/ tcp dpt:8080
3    RETURN     all  <span class="nt">--</span>  0.0.0.0/0            0.0.0.0/0
</pre></table></code></div></div><ul><li><strong>1번 DNAT 룰</strong>: 첫 번째 백엔드 Pod로 DNAT.<li><strong>2번 DNAT 룰</strong>: 두 번째 백엔드 Pod로 DNAT.<li><strong>3번 RETURN</strong>: 매칭 실패 시 복귀.</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nv">$ </span>iptables <span class="nt">-t</span> nat <span class="nt">-L</span> KUBE-MARK-MASQ <span class="nt">-n</span> <span class="nt">--line-numbers</span>

Chain KUBE-MARK-MASQ <span class="o">(</span>1 references<span class="o">)</span>
num  target     prot opt <span class="nb">source               </span>destination
1    MARK       all  <span class="nt">--</span>  0.0.0.0/0            10.96.0.0/12       MARK <span class="nb">set </span>0x4000
</pre></table></code></div></div><ul><li><strong>MASQ 표시</strong>: Service 외부(외부IP 또는 NodePort)로 나가는 패킷에 마스커레이드를 적용해야 할 때, 이 마크를 보고 SNAT을 수행합니다.</ul><h4 id="ipvsip-virtual-server-모드"><span class="me-2">IPVS(IP Virtual Server) 모드</span><a href="#ipvsip-virtual-server-모드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>kube-proxy가 IPVS 모드로 동작할 때는, 리눅스 커널의 IP Virtual Server 기능을 이용해 가상 서버(Virtual Server) 를 띄우고, 여기에 실제 백엔드 Pod(Real Servers) 를 등록하는 방식으로 로드밸런싱을 수행합니다.</p><h5 id="작동-과정"><span class="me-2">작동 과정</span><a href="#작동-과정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><ol><li>리눅스의 커널 레벨의 IPVS 프레임워크에 Service Virtual Server(VS)를 생성합니다.<li>각 Endpoint(Backend) 서버를 Virtual Server에 등록합니다.<li>IPVS 스케줄러(rr, lc, wlc 등)로 트래픽 분배합니다.</ol><dl><dt>장점은<dd>대규모 Service 처리 시 iptables 대비 더 빠르고, 룰 관리가 간단합니다.<dd>RR(Round Robin)뿐만 아니라, 다양한 스케줄러 모드를 지원합니다.<dt>단점은<dd>커널 모듈 의존성(CentOS/RHEL 등 커널 패치 필요)이 있어서, 초기 세팅이 어렵습니다.</dl><h3 id="내부-구성요소"><span class="me-2">내부 구성요소</span><a href="#내부-구성요소" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><p>Watcher<br /> API Server의 /services 및 /endpoints 리소스를 계속해서 감시합니다.</p><li><p>Proxier<br /> 모드(iptables/IPVS)별로 룰을 생성하고 갱신합니다.</p><li><p>Local Manager<br /> Node 로컬 네트워크에 바인딩 혹은 해제된 포트를 관리합니다.</p><li><p>Metrics Server<br /> <code class="language-plaintext highlighter-rouge">kube_proxy_metrics</code> 을 통해, 연결 / 종료 건수나 오류율 등을 노출시킵니다.</p></ul><h3 id="service-처리-flow"><span class="me-2">Service 처리 Flow</span><a href="#service-처리-flow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/img/for-post/k8s%20data%20plane/image%204.png" class="popup img-link shimmer"><img src="/assets/img/for-post/k8s%20data%20plane/image%204.png" alt="클라이언트 Pod에서 다른 노드의 서버 Pod로의 트래픽 흐름" loading="lazy"></a> <em>클라이언트 Pod에서 다른 노드의 서버 Pod로의 트래픽 흐름</em></p><ol><li><p>kube-proxy에서 iptables를 최신상태로 갱신합니다.<br /> ‘kube-proxy’는 API Server를 통해, Pod 목록(라우팅 대상)을 갱신하며, 이를 각 Node의 ‘iptables’에 Rule로 반영합니다.</p><li><p>클라이언트 Pod에서는 Cluster내부의 Service를 호출합니다.</p><li><p>Service 호출 traffic은 Client Pod이 있는 Node의 iptables에 의해, 목적지 IP와 Port번호가 갱신되어, Backend Pod에 전달됩니다.<br /> iptables의 DNAT(Destination NAT) Rule을 이용해, ‘목적지 IP(Cluster 수준의 IP)’ → ‘Backend Pod의 IP’로 변경됩니다.</p></ol><h3 id="kube-proxy를-다른것으로-대체할-수-있습니다"><span class="me-2">kube-proxy를 다른것으로 대체할 수 있습니다.</span><a href="#kube-proxy를-다른것으로-대체할-수-있습니다" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://kubernetes.io/docs/concepts/architecture/#kube-proxy">Kubernetes의 공식문서</a>에 보면, ‘kube-proxy’는 Optional로 표현되어 있는데, 이는 서비스 트래픽에 대한 proxy역할을 ‘kube-proxy’가 아니어도 대체할 수 있기 때문입니다.</p><h4 id="service-mesh-솔루션"><span class="me-2">Service Mesh 솔루션</span><a href="#service-mesh-솔루션" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Istio, Linkerd, Kuma 같은 서비스 메시를 쓰면, Envoy, dataplane 에이전트가 Pod 간·외부 트래픽을 가로채어 처리하며, kube-proxy를 건너뛰고도 충분한 로드밸런싱/리트라이정책 적용이 가능합니다.</p><h4 id="headless-서비스"><span class="me-2">Headless 서비스</span><a href="#headless-서비스" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>ClusterIP를 쓰지 않고 DNS 기반으로 Endpoint IP 리스트를 Pod가 직접 조회해 접속하는 패턴(headless service)을 쓰면, kube-proxy가 아예 개입할 여지가 없습니다.</p><h2 id="container-runtime"><span class="me-2">Container runtime</span><a href="#container-runtime" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><blockquote><p>A fundamental component that empowers Kubernetes to run containers effectively. - kubernetes.io</p></blockquote><p>‘Container runtime’은 Kubernetes의 Pod에 있는 Container를 돌리는 runtime환경입니다.<br /> Container에 대한 실행과 Lifecycle관리에 대한 책임을 갖고 있습니다.</p><h3 id="container-runtime-interfacecri"><span class="me-2">Container Runtime Interface(CRI)</span><a href="#container-runtime-interfacecri" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Kubernetes에선, kubelet과 ‘Container Runtime’이 gRPC로 통신할 수 있는 Interface를 지원합니다. 이를 ‘Container Runtime Interface(CRI)’라고 합니다.</p><p><br /></p><p>Kubernetes에서는 CRI를 이용하여, 여러 Container Runtime을 지원합니다.</p><h4 id="containerd"><span class="me-2"><a href="https://containerd.io/docs/">container.d</a></span><a href="#containerd" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>CNCF 프로젝트였으며, Docker의 핵심만 분리하여 경량화한 runtime입니다.<br /> Kubernetes v1.24 이후부터는 ‘container.d’가 <strong>default runtime</strong>입니다.</p><blockquote class="prompt-info"><p>Q: Docker Engine에서 container.d로 default runtime이 바뀌게된 이유?<br /> A: Docker Engine은 OCI(Open Container Initiative) 규격보다 훨씬 많은 기능(빌드, 네트워크 관리, 로그 드라이버 등)을 포함한 “풀 스택” 플랫폼이었고, 이를 CRI로 감싸기 위해 dockershim이라는 중간 계층(shim)을 유지해야 했습니다.<br /> containerd는 애초에 OCI 런타임에만 집중한 경량 서비스로, CRI 플러그인을 붙이면 kubelet과 직접 통신할 수 있어(shim계층 불필요) default runtime으로 자리잡게 되었습니다.</p></blockquote><h4 id="cri-o"><span class="me-2"><a href="https://cri-o.io/#what-is-cri-o">CRI-O</a></span><a href="#cri-o" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>‘Red Hat’의 주도로 만들어진, OpenShift(Red hat의 k8s기반 오케스트레이션 플랫폼)에 최적화된 runtime입니다.</p><h3 id="cgroupcontrol-groups-drivers"><span class="me-2"><a href="https://kubernetes.io/docs/setup/production-environment/container-runtimes/#cgroup-drivers">cgroup(control groups) Drivers</a></span><a href="#cgroupcontrol-groups-drivers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Linux의 ‘cgroup(Control Groups)’은 컨테이너 런타임이 ‘리소스 격리 및 할당’을 위해 사용하는 핵심 커널 기능입니다.<br /> cgroup은 프로세스(또는 프로세스 그룹)에 대해 CPU, 메모리, 블록 I/O, PID 수 등을 강제로 제한 / 계측하고, 우선순위를 지정할 수 있게 해 줍니다.</p><h4 id="kubernetes에서의-활용"><span class="me-2">Kubernetes에서의 활용</span><a href="#kubernetes에서의-활용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>kubelet에서는 <code class="language-plaintext highlighter-rouge">--cgroup-driver</code> 를 통해, cgroup으로 사용할 드라이버를 설정할 수 있습니다.<br /> 아래와 같은 2가지 드라이버가 가능한 옵션입니다.</p><ul><li>cgroupfs<li>systemd</ul><h2 id="실습"><span class="me-2">실습</span><a href="#실습" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="data-plane의-node-조회"><span class="me-2">Data Plane의 Node 조회</span><a href="#data-plane의-node-조회" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="cluster의-노드-목록-조회"><span class="me-2">Cluster의 노드 목록 조회</span><a href="#cluster의-노드-목록-조회" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>~ kubectl get nodes
NAME                                              STATUS   ROLES    AGE     VERSION
ip-10-20-99-219.ap-northeast-2.compute.internal   Ready    &lt;none&gt;   8m58s   v1.32.1-eks-5d632ec
</pre></table></code></div></div><h4 id="개별-node의-세부-사항-조회"><span class="me-2">개별 Node의 세부 사항 조회</span><a href="#개별-node의-세부-사항-조회" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
</pre><td class="rouge-code"><pre><span class="nv">$ </span>kubectl describe nodes ip-10-20-99-219.ap-northeast-2.compute.internal
Name:               ip-10-20-99-219.ap-northeast-2.compute.internal
Roles:              &lt;none&gt;
Labels:             beta.kubernetes.io/arch<span class="o">=</span>amd64
                    beta.kubernetes.io/instance-type<span class="o">=</span>t3.large
                    beta.kubernetes.io/os<span class="o">=</span>linux
                    ...
Annotations:        alpha.kubernetes.io/provided-node-ip: 10.20.99.219
                    node.alpha.kubernetes.io/ttl: 0
                    volumes.kubernetes.io/controller-managed-attach-detach: <span class="nb">true
</span>CreationTimestamp:  Thu, 10 Jul 2025 17:27:37 +0900
Taints:             &lt;none&gt;
Unschedulable:      <span class="nb">false
</span>Lease:
  HolderIdentity:  ip-10-20-99-219.ap-northeast-2.compute.internal
  AcquireTime:     &lt;<span class="nb">unset</span><span class="o">&gt;</span>
  RenewTime:       Thu, 10 Jul 2025 17:38:31 +0900
Conditions:
  Type             Status  LastHeartbeatTime                 LastTransitionTime                Reason                       Message
  <span class="nt">----</span>             <span class="nt">------</span>  <span class="nt">-----------------</span>                 <span class="nt">------------------</span>                <span class="nt">------</span>                       <span class="nt">-------</span>
  MemoryPressure   False   Thu, 10 Jul 2025 17:34:34 +0900   Thu, 10 Jul 2025 17:27:33 +0900   KubeletHasSufficientMemory   kubelet has sufficient memory available
  DiskPressure     False   Thu, 10 Jul 2025 17:34:34 +0900   Thu, 10 Jul 2025 17:27:33 +0900   KubeletHasNoDiskPressure     kubelet has no disk pressure
  PIDPressure      False   Thu, 10 Jul 2025 17:34:34 +0900   Thu, 10 Jul 2025 17:27:33 +0900   KubeletHasSufficientPID      kubelet has sufficient PID available
  Ready            True    Thu, 10 Jul 2025 17:34:34 +0900   Thu, 10 Jul 2025 17:27:56 +0900   KubeletReady                 kubelet is posting ready status
Addresses:
  InternalIP:   10.20.99.219
  InternalDNS:  ip-10-20-99-219.ap-northeast-2.compute.internal
  Hostname:     ip-10-20-99-219.ap-northeast-2.compute.internal
Capacity:
  cpu:                2
  ephemeral-storage:  31379436Ki
  hugepages-1Gi:      0
  hugepages-2Mi:      0
  memory:             7999148Ki
  pods:               35
Allocatable:
  cpu:                1930m
  ephemeral-storage:  27845546346
  hugepages-1Gi:      0
  hugepages-2Mi:      0
  memory:             7241388Ki
  pods:               35
System Info:
  Machine ID:                 ...
  System UUID:                ...
  Boot ID:                    ...
  Kernel Version:             6.1.127-135.201.amzn2023.x86_64
  OS Image:                   Amazon Linux 2023.6.20250203
  Operating System:           linux
  Architecture:               amd64
  Container Runtime Version:  containerd://1.7.25
  Kubelet Version:            v1.32.1-eks-5d632ec
  Kube-Proxy Version:         v1.32.1-eks-5d632ec
ProviderID:                   aws:///ap-northeast-2c/i-0288f536d015d5e34
Non-terminated Pods:          <span class="o">(</span>4 <span class="k">in </span>total<span class="o">)</span>
  Namespace                   Name                        CPU Requests  CPU Limits  Memory Requests  Memory Limits  Age
  <span class="nt">---------</span>                   <span class="nt">----</span>                        <span class="nt">------------</span>  <span class="nt">----------</span>  <span class="nt">---------------</span>  <span class="nt">-------------</span>  <span class="nt">---</span>
  kube-system                 aws-node-496nj              50m <span class="o">(</span>2%<span class="o">)</span>      0 <span class="o">(</span>0%<span class="o">)</span>      0 <span class="o">(</span>0%<span class="o">)</span>           0 <span class="o">(</span>0%<span class="o">)</span>         9m23s
  kube-system                 coredns-586c6dd46b-5s5cc    100m <span class="o">(</span>5%<span class="o">)</span>     0 <span class="o">(</span>0%<span class="o">)</span>      70Mi <span class="o">(</span>0%<span class="o">)</span>        170Mi <span class="o">(</span>2%<span class="o">)</span>     9m36s
  kube-system                 coredns-586c6dd46b-vsdfd    100m <span class="o">(</span>5%<span class="o">)</span>     0 <span class="o">(</span>0%<span class="o">)</span>      70Mi <span class="o">(</span>0%<span class="o">)</span>        170Mi <span class="o">(</span>2%<span class="o">)</span>     9m36s
  kube-system                 kube-proxy-nc5tm            100m <span class="o">(</span>5%<span class="o">)</span>     0 <span class="o">(</span>0%<span class="o">)</span>      0 <span class="o">(</span>0%<span class="o">)</span>           0 <span class="o">(</span>0%<span class="o">)</span>         10m
Allocated resources:
  <span class="o">(</span>Total limits may be over 100 percent, i.e., overcommitted.<span class="o">)</span>
  Resource           Requests    Limits
  <span class="nt">--------</span>           <span class="nt">--------</span>    <span class="nt">------</span>
  cpu                350m <span class="o">(</span>18%<span class="o">)</span>  0 <span class="o">(</span>0%<span class="o">)</span>
  memory             140Mi <span class="o">(</span>1%<span class="o">)</span>  340Mi <span class="o">(</span>4%<span class="o">)</span>
  ephemeral-storage  0 <span class="o">(</span>0%<span class="o">)</span>      0 <span class="o">(</span>0%<span class="o">)</span>
  hugepages-1Gi      0 <span class="o">(</span>0%<span class="o">)</span>      0 <span class="o">(</span>0%<span class="o">)</span>
  hugepages-2Mi      0 <span class="o">(</span>0%<span class="o">)</span>      0 <span class="o">(</span>0%<span class="o">)</span>
Events:
  Type     Reason                   Age                From                   Message
  <span class="nt">----</span>     <span class="nt">------</span>                   <span class="nt">----</span>               <span class="nt">----</span>                   <span class="nt">-------</span>
  Normal   Starting                 10m                kube-proxy
  Normal   Starting                 10m                kubelet                Starting kubelet.
  Warning  InvalidDiskCapacity      10m                kubelet                invalid capacity 0 on image filesystem
  Normal   NodeHasSufficientMemory  10m <span class="o">(</span>x2 over 10m<span class="o">)</span>  kubelet                Node ip-10-20-99-219.ap-northeast-2.compute.internal status is now: NodeHasSufficientMemory
  Normal   NodeHasNoDiskPressure    10m <span class="o">(</span>x2 over 10m<span class="o">)</span>  kubelet                Node ip-10-20-99-219.ap-northeast-2.compute.internal status is now: NodeHasNoDiskPressure
  Normal   NodeHasSufficientPID     10m <span class="o">(</span>x2 over 10m<span class="o">)</span>  kubelet                Node ip-10-20-99-219.ap-northeast-2.compute.internal status is now: NodeHasSufficientPID
  Normal   NodeAllocatableEnforced  10m                kubelet                Updated Node Allocatable limit across pods
  Normal   Synced                   10m                cloud-node-controller  Node synced successfully
  Normal   RegisteredNode           10m                node-controller        Node ip-10-20-99-219.ap-northeast-2.compute.internal event: Registered Node ip-10-20-99-219.ap-northeast-2.compute.internal <span class="k">in </span>Controller
  Normal   NodeReady                10m                kubelet                Node ip-10-20-99-219.ap-northeast-2.compute.internal status is now: NodeReady
</pre></table></code></div></div><h3 id="node의-system-component-조회"><span class="me-2">Node의 System Component 조회</span><a href="#node의-system-component-조회" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="node의-system-component-조회-1"><span class="me-2">Node의 System Component 조회</span><a href="#node의-system-component-조회-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span>kubectl get pods <span class="nt">--namespace</span><span class="o">=</span>kube-system <span class="nt">--field-selector</span> spec.nodeName<span class="o">=</span>ip-10-20-99-219.ap-northeast-2.compute.internal
NAME                       READY   STATUS    RESTARTS   AGE
aws-node-496nj             2/2     Running   0          17m <span class="c">## Amazon VPC CNI 플러그인</span>
coredns-586c6dd46b-5s5cc   1/1     Running   0          17m
coredns-586c6dd46b-vsdfd   1/1     Running   0          17m
kube-proxy-nc5tm           1/1     Running   0          18m
</pre></table></code></div></div><h4 id="kube-proxy-조회"><span class="me-2">kube-proxy 조회</span><a href="#kube-proxy-조회" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>kubectl get daemonSets <span class="nt">--namespace</span><span class="o">=</span>kube-system kube-proxy
NAME         DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE
kube-proxy   1         1         1       1            1           &lt;none&gt;          18m
</pre></table></code></div></div><h4 id="cluster의-dns-deployments-조회"><span class="me-2">Cluster의 DNS Deployments 조회</span><a href="#cluster의-dns-deployments-조회" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>kubectl get deployments <span class="nt">--namespace</span><span class="o">=</span>kube-system coredns
NAME      READY   UP-TO-DATE   AVAILABLE   AGE
coredns   2/2     2            2           25m
</pre></table></code></div></div><h4 id="dns에-대한-service조회"><span class="me-2">DNS에 대한 Service조회</span><a href="#dns에-대한-service조회" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>kubectl get services <span class="nt">--namespace</span><span class="o">=</span>kube-system kube-dns
NAME       TYPE        CLUSTER-IP    EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>                  AGE
kube-dns   ClusterIP   172.20.0.10   &lt;none&gt;        53/UDP,53/TCP,9153/TCP   28m
</pre></table></code></div></div><h2 id="references"><span class="me-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><dl><dt>Nodes | kubernetes.io<dd><a href="https://kubernetes.io/docs/concepts/architecture/nodes/">Nodes</a><dt>Node Components | kubernetes.io<dd><a href="https://kubernetes.io/docs/concepts/overview/components/#node-components">Kubernetes Components</a><dt>Pod Lifecycle | kubernetes.io<dd><a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/">Pod Lifecycle</a><dt>Container Storage Interface(CSI) for Kubernetes GA | kubernetes.io<dd><a href="https://kubernetes.io/blog/2019/01/15/container-storage-interface-ga/">Container Storage Interface (CSI) for Kubernetes GA</a><dt>Container Storage Interface(CSI) spec | github.com/container-storage-interface/spec<dd><a href="https://github.com/container-storage-interface/spec/blob/master/spec.md">https://github.com/container-storage-interface/spec/blob/master/spec.md</a><dt>kube-proxy | kubernetes.io<dd><a href="https://kubernetes.io/docs/reference/command-line-tools-reference/kube-proxy/">kube-proxy</a><dt>Virtual IPs and Service Proxies | kubernetes.io<dd><a href="https://kubernetes.io/docs/reference/networking/virtual-ips/">Virtual IPs and Service Proxies</a><dt>Iptables proxy mode | kubernetes.io<dd><a href="https://kubernetes.io/docs/reference/networking/virtual-ips/#proxy-mode-iptables">Virtual IPs and Service Proxies</a><dt>IPVS proxy mode | kubernetes.io<dd><a href="https://kubernetes.io/docs/reference/networking/virtual-ips/#proxy-mode-ipvs">Virtual IPs and Service Proxies</a><dt>Service ClusterIP allocation | kubernetes.io<dd><a href="https://kubernetes.io/docs/concepts/services-networking/cluster-ip-allocation/">Service ClusterIP allocation</a><dt>Kubernetes’s IPTables Chains Are Not API | kubernetes.io<dd><a href="https://kubernetes.io/blog/2022/09/07/iptables-chains-not-api/">Kubernetes’s IPTables Chains Are Not API</a><dt>Kubernetes networking demystified: a brief guide | cncf.io<dd><a href="https://www.cncf.io/blog/2020/01/30/kubernetes-networking-demystified-a-brief-guide/">Kubernetes networking demystified: a brief guide</a><dt>kube-proxy | GKE networking overview | Google Cloud<dd><a href="https://cloud.google.com/kubernetes-engine/docs/concepts/network-overview?hl=ko#kube-proxy">네트워크 개요 | Google Kubernetes Engine (GKE) | Google Cloud</a><dt>Container Runtime Interface(CRI) | github.com/kubernetes/community<dd><a href="https://github.com/kubernetes/community/blob/master/contributors/devel/sig-node/container-runtime-interface.md">https://github.com/kubernetes/community/blob/master/contributors/devel/sig-node/container-runtime-interface.md</a><dt>Container Runtimes | kubernetes.io<dd><a href="https://kubernetes.io/docs/setup/production-environment/container-runtimes/">Container Runtimes</a></dl></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/devops/">DevOps</a>, <a href="/categories/kubernetes/">kubernetes</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/aws/" class="post-tag no-text-decoration" >aws</a> <a href="/tags/kubernetes/" class="post-tag no-text-decoration" >kubernetes</a> <a href="/tags/cncf/" class="post-tag no-text-decoration" >cncf</a> <a href="/tags/k8s/" class="post-tag no-text-decoration" >k8s</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Components%20-%20Data%20Plane(Node)%20%7C%20Kubernetes%20Deep%20Dive%20-%203%20-%20KanghoonYi(Pour)&url=https%3A%2F%2Fblog.devpour.net%2Fposts%2Fk8s-data-plane%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Components%20-%20Data%20Plane(Node)%20%7C%20Kubernetes%20Deep%20Dive%20-%203%20-%20KanghoonYi(Pour)&u=https%3A%2F%2Fblog.devpour.net%2Fposts%2Fk8s-data-plane%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fblog.devpour.net%2Fposts%2Fk8s-data-plane%2F&text=Components%20-%20Data%20Plane(Node)%20%7C%20Kubernetes%20Deep%20Dive%20-%203%20-%20KanghoonYi(Pour)" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/Redis/">Redis | Key Technologies - System Design Interview</a><li class="text-truncate lh-lg"> <a href="/posts/Consistent-Hashing/">Consistent Hashing | Core Concepts - System Design Interview</a><li class="text-truncate lh-lg"> <a href="/posts/k8s-introduction/">Kubernetes(Orchestration) 개론</a><li class="text-truncate lh-lg"> <a href="/posts/CAP-Theorem/">CAP Theorem(정리) | Core Concepts - System Design Interview</a><li class="text-truncate lh-lg"> <a href="/posts/What-is-CloudNativePG/">What is CloudNativePG? | CloudNative</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/leetcode/">leetcode</a> <a class="post-tag btn btn-outline-primary" href="/tags/rust/">rust</a> <a class="post-tag btn btn-outline-primary" href="/tags/computer-science/">Computer Science</a> <a class="post-tag btn btn-outline-primary" href="/tags/cncf/">cncf</a> <a class="post-tag btn btn-outline-primary" href="/tags/k8s/">k8s</a> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a> <a class="post-tag btn btn-outline-primary" href="/tags/architecture/">Architecture</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/k8s-introduction/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1750777740" data-df="ll" > Jun 25, 2025 </time><h4 class="pt-0 my-2">Kubernetes(Orchestration) 개론</h4><div class="text-muted"><p>오늘날, IT서비스를 구성할때, Kubernetes와 같은 Orchestration 환경을 기본으로 시작하게 됩니다. 여기서는, 이런 배경을 알아보고자 합니다. Kubernetes의 성장 배경 Kubernetes가 오늘날 처럼 인프라 운영의 핵심으로 자리 잡기 까지, 여러 배경이 있습니다. 더 빨라진 비지니스 변화 → 잦은 배포가 발생합니다....</p></div></div></a></article><article class="col"> <a href="/posts/k8s-workloads/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1752036600" data-df="ll" > Jul 9, 2025 </time><h4 class="pt-0 my-2">Workloads | Kubernetes Deep Dive - 4</h4><div class="text-muted"><p>Kubernetes는 Infra에 대한 추상화를 제공하는 Framework입니다. 이때, 가장 기본이 되는 추상화 단위가 ‘Pod(파드)’입니다. 이 Pod를 어떻게 다루느냐(Workload Management)에 따라, 한 단계 더 추상화된, ‘Deployments’, ‘ReplicaSet’, ‘DaemonSet’등의 Workload Object가...</p></div></div></a></article><article class="col"> <a href="/posts/k8s-control-plane/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1751282040" data-df="ll" > Jun 30, 2025 </time><h4 class="pt-0 my-2">Components - Control Plane | Kubernetes Deep Dive - 2</h4><div class="text-muted"><p>Kubernetes에서 ‘Control Plane’은 Cluster를 운영하는 Core혹은 ‘뇌’의 역할을 합니다. Cluster를 다루기 위한 API요청을 검증하고, 상태를 저장하고, 요청을 실행시키고, Cluster를 유지하는 역할을 합니다. 여기서는 ‘Control Plane’이 어떤 Component를 통해 이런 역할을 수행하는지 알아봅니다. ...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/ChatGPT-API-Pricing-N-Bulk-Request/" class="btn btn-outline-primary" aria-label="Older" ><p>ChatGPT API 비용최적화 및 Bulk요청 보내기 | Prompt Engineering</p></a> <a href="/posts/Understanding-https-certificates/" class="btn btn-outline-primary" aria-label="Newer" ><p>HTTPS 이해하기</p></a></nav><script src="https://utteranc.es/client.js" repo="KanghoonYi/kanghoonyi.github.io" issue-term="pathname" crossorigin="anonymous" async ></script> <script type="text/javascript"> (function () { const origin = 'https://utteranc.es'; const lightTheme = 'github-light'; const darkTheme = 'github-dark'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } addEventListener('message', (event) => { let theme;if (event.origin === origin) {theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {const mode = event.data.message; theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; } else { return; } const message = { type: 'set-theme', theme: theme }; const utterances = document.getElementsByClassName('utterances-frame')[0].contentWindow; utterances.postMessage(message, origin); }); })(); </script><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2025</time> <a href="https://github.com/KanghoonYi">KanghoonYi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/leetcode/">leetcode</a> <a class="post-tag btn btn-outline-primary" href="/tags/rust/">rust</a> <a class="post-tag btn btn-outline-primary" href="/tags/computer-science/">Computer Science</a> <a class="post-tag btn btn-outline-primary" href="/tags/cncf/">cncf</a> <a class="post-tag btn btn-outline-primary" href="/tags/k8s/">k8s</a> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a> <a class="post-tag btn btn-outline-primary" href="/tags/architecture/">Architecture</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
