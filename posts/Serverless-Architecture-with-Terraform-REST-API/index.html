<!doctype html><html lang="ko" data-mode="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Serverless Architecture with Terraform - REST API" /><meta name="author" content="KanghoonYi(pour)" /><meta property="og:locale" content="ko" /><meta name="description" content="들어가면서" /><meta property="og:description" content="들어가면서" /><link rel="canonical" href="https://blog.devpour.net/posts/Serverless-Architecture-with-Terraform-REST-API/" /><meta property="og:url" content="https://blog.devpour.net/posts/Serverless-Architecture-with-Terraform-REST-API/" /><meta property="og:site_name" content="KanghoonYi(Pour)" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-04-01T11:33:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Serverless Architecture with Terraform - REST API" /><meta name="google-site-verification" content="rsx_-5MJzSR_3NNCqHNe9IxnKJxlD8Eid8_wN8e9c1I" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"KanghoonYi(pour)","url":"https://www.linkedin.com/in/pour/"},"dateModified":"2025-06-25T00:39:46+09:00","datePublished":"2025-04-01T11:33:00+09:00","description":"들어가면서","headline":"Serverless Architecture with Terraform - REST API","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.devpour.net/posts/Serverless-Architecture-with-Terraform-REST-API/"},"url":"https://blog.devpour.net/posts/Serverless-Architecture-with-Terraform-REST-API/"}</script><title>Serverless Architecture with Terraform - REST API | KanghoonYi(Pour)</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="KanghoonYi(Pour)"><meta name="application-name" content="KanghoonYi(Pour)"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/pour_profile_img.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/">KanghoonYi(Pour)</a></h1><p class="site-subtitle fst-italic mb-0">안녕하세요~ Software Engineer pour입니다 This is Pour.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/KanghoonYi" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['rkdgnsdls','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Serverless Architecture with Terraform - REST API</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Serverless Architecture with Terraform - REST API</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1743474780" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 1, 2025 </time> </span> <span> Updated <time data-ts="1750779586" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 25, 2025 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://www.linkedin.com/in/pour/">KanghoonYi(pour)</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2465 words" > <em>13 min</em> read</span></div></div></div></header><div class="content"><h2 id="들어가면서"><span class="me-2">들어가면서</span><a href="#들어가면서" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>회사의 비지니스적인 상황에 따라서, Serverless Architecture(AWS Lambda + API gateway)를 사용할때가 있습니다. <br /> Serverless 환경에서 개발할때에 여러 어려움중에 하나가, 개발 Cycle에 대한 불편함인데,<br /> Local에서 HTTP server를 구동하는게 어려워서, AWS Lambda에 배포하여 테스트하는 경우가 많다는 겁니다.<br /> 역시, 이런 어려움은 저만 겪는게 아니라, 이미 Solution이 있습니다. 바로 ‘<a href="https://www.serverless.com/">Serverless Framework</a>’입니다.</p><h3 id="serverless-framework의-아쉬운점"><span class="me-2"><a href="https://www.serverless.com/">Serverless Framework</a>의 아쉬운점</span><a href="#serverless-framework의-아쉬운점" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>‘Serverless Framework’는 ‘Serverless-Offline’모듈을 통해, Local환경에서 Lambda기반의 HTTP Server를 가상화해서 활용할 수 있습니다.<br /> 또한, ‘Serverless Framework‘로 자동화된 배포까지 구현할 수 있습니다.<br /> 즉, ‘개발환경’과 ‘배포환경’을 하나의 Framework로 다룰 수 있습니다.</p><p>‘Serverless Framework’는 AWS의 CloudFormation 기반으로 작동합니다. 때문에, Cloudformation기반으로 인프라의 State를 자동으로 맞춰주고, Rollback까지 손쉽게 진행할 수 있습니다.<br /> 하지만, <strong>많은 회사에서 이미 ‘Terraform’을 IaC(Infrastructure as Code)도구로 사용할텐데, 별도의 IaC Stack을 추가하는건 피하게 됩니다</strong>.</p><p>때문에, ‘Terraform을 이용해서, Serverless framework와 같이 구현할 수 있지 않을까?’라는 생각으로 이 포스팅을 진행하게 되었습니다.</p><h2 id="본문"><span class="me-2">본문</span><a href="#본문" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>먼저 작업을 완료한 Repository를 공유합니다. 이 포스팅과 함께 내용을 따라오시면, 이해에 도움이 되실겁니다.<br /> <a href="https://github.com/KanghoonYi/terraform-aws-examples/tree/main/examples/lambda-base/apigateway">terraform-aws-examples/examples/lambda-base/apigateway at main · KanghoonYi/terraform-aws-examples</a> <em>(Terraform 기반의 serverless architecture example)</em></p><h3 id="접근-방법-및-과정"><span class="me-2">접근 방법 및 과정</span><a href="#접근-방법-및-과정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Terraform자체는 IaC도구로서, Application Code를 handling하는 기능은 없습니다.</p><dl><dt>때문에, 다음과 같은 기능을 직접 구현해야 합니다.<dd>Source Code를 Lambda용으로 build (외부모듈 dependency를 포함하여 zip파일로 생성)<dd>Source Code기반으로 HTTP server를 Local환경에 가상화</dl><p>이를 통해, ‘AWS Lambda’를 생성하는 과정을 자동화 하게 됩니다.<br /> 이후, API Gateway에 연결하기 위해 이 설정에 ‘API Gateway’에 대한 dependency를 설정하게 됩니다.</p><p>이렇게 해서 완료된 환경을 AWS의 <a href="https://aws.amazon.com/ko/blogs/compute/better-together-aws-sam-cli-and-hashicorp-terraform/">Guide</a>에 따라, ‘AWS SAM’으로 Local에서 HTTP server로 가상화하여 구동하게 됩니다.</p><h3 id="terraform의-module기능-활용"><span class="me-2">Terraform의 Module기능 활용</span><a href="#terraform의-module기능-활용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Terraform환경에서 Lambda를 쉽게 활용하기 위한 별도의 <a href="https://registry.terraform.io/modules/terraform-aws-modules/lambda/aws/latest">Module</a>이 준비되어 있지만, 이 Module은 여전히 API Gateway와의 Dependency나 Execution Role과 같이 설정할 것들이 많습니다.<br /> 이를 해소하고자, <a href="https://registry.terraform.io/modules/terraform-aws-modules/lambda/aws/latest">terraform-aws-modules/lambda/aws</a> 모듈 기반의 Custom 모듈을 정의해서 사용합니다.<br /> <a href="https://github.com/KanghoonYi/terraform-aws-examples/tree/main/examples/lambda-base/apigateway/tfModules/APIGatewayHandler">terraform-aws-examples/examples/lambda-base/apigateway/tfModules/APIGatewayHandler at main · KanghoonYi/terraform-aws-examples</a></p><h3 id="source-code-build"><span class="me-2">Source Code Build</span><a href="#source-code-build" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="https://github.com/KanghoonYi/terraform-aws-examples/blob/main/examples/lambda-base/apigateway/package.json">https://github.com/KanghoonYi/terraform-aws-examples/blob/main/examples/lambda-base/apigateway/package.json</a></p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="err">#</span><span class="w"> </span><span class="err">examples/lambda-base/apigateway/package.json</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"apigateway"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"module"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"build:dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NODE_ENV=dev tsx esbuild.ts &amp;&amp; (cd .esbuild &amp;&amp; npm install --omit=dev)"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"build:prod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NODE_ENV=production tsx esbuild.ts &amp;&amp; (cd .esbuild &amp;&amp; npm install --omit=dev)"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"local-run:dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sam local start-api --hook-name terraform --beta-features"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">...</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p><a href="https://github.com/KanghoonYi/terraform-aws-examples/blob/main/examples/lambda-base/apigateway/esbuild.ts">https://github.com/KanghoonYi/terraform-aws-examples/blob/main/examples/lambda-base/apigateway/esbuild.ts</a></p><div class="language-tsx highlighter-rouge"><div class="code-header"> <span data-label-text="Tsx"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre><span class="c1">// examples/lambda-base/apigateway/esbuild.ts</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">globSync</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">glob</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">esbuildModule</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">esbuild</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">packageJsonPlugin</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">esbuild-plugin-package-json</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="o">*</span> <span class="kd">as </span><span class="nx">process</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">node:process</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">entryFilePaths</span> <span class="o">=</span> <span class="nf">globSync</span><span class="p">(</span><span class="dl">'</span><span class="s1">src/functions/**/handler.ts</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
  <span class="c1">// root: path.resolve(__dirname, 'src/functions'),</span>
  <span class="na">nodir</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">dotRelative</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">});</span>

<span class="p">(</span><span class="k">async </span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">buildResult</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">esbuildModule</span><span class="p">.</span><span class="nf">build</span><span class="p">({</span>
    <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span><span class="nf">packageJsonPlugin</span><span class="p">()],</span>
    <span class="na">entryPoints</span><span class="p">:</span> <span class="nx">entryFilePaths</span><span class="p">,</span>
    <span class="na">entryNames</span><span class="p">:</span> <span class="dl">'</span><span class="s1">[dir]/[name]</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">outbase</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">outdir</span><span class="p">:</span> <span class="dl">'</span><span class="s1">.esbuild</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">bundle</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">platform</span><span class="p">:</span> <span class="dl">'</span><span class="s1">node</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">tsconfig</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./tsconfig.json</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">treeShaking</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">packages</span><span class="p">:</span> <span class="dl">'</span><span class="s1">external</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">sourcemap</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">minify</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">production</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">format</span><span class="p">:</span> <span class="dl">'</span><span class="s1">esm</span><span class="dl">'</span><span class="p">,</span>
  <span class="p">});</span>
  <span class="k">return</span> <span class="nx">buildResult</span><span class="p">;</span>
<span class="p">})().</span><span class="k">catch</span><span class="p">((</span><span class="nx">reason</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="nx">reason</span><span class="p">);</span>
  <span class="nx">process</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">});</span>

</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">package.json</code> 의 ‘script’를 이용하여, nodejs기반의 Lambda source code를 build하는 과정을 명시합니다.<br /> <code class="language-plaintext highlighter-rouge">NODE_ENV=dev tsx esbuild.ts &amp;&amp; (cd .esbuild &amp;&amp; npm install --omit=dev)</code></p><ol><li><p><code class="language-plaintext highlighter-rouge">NODE_ENV=dev tsx esbuild.ts</code><br /> ‘tsx’를 이용해서 source code를 build하는것을 말합니다.</p><li><p><code class="language-plaintext highlighter-rouge">cd .esbuild &amp;&amp; npm install --omit=dev</code><br /> build된 결과물을 기준으로, 외부 dependency를 다시 설치합니다.</p></ol><h3 id="souce-code-build-과정을-terraform에-표현하기"><span class="me-2">Souce Code build 과정을 Terraform에 표현하기</span><a href="#souce-code-build-과정을-terraform에-표현하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>여기서는 Terraform에서 Source code build 과정을 명시해주고, Local 구동이 가능하게 ‘AWS SAM Metdata’를 자동으로 생성하게 해줘야 합니다.</p><p><a href="https://github.com/KanghoonYi/terraform-aws-examples/blob/main/examples/lambda-base/apigateway/tfModules/APIGatewayHandler/main.tf">https://github.com/KanghoonYi/terraform-aws-examples/blob/main/examples/lambda-base/apigateway/tfModules/APIGatewayHandler/main.tf</a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre><span class="c"># examples/lambda-base/apigateway/tfModules/APIGatewayHandler/main.tf</span>

locals <span class="o">{</span>
  esbuild_src   <span class="o">=</span> <span class="s2">"./.esbuild"</span>
  function_name <span class="o">=</span> <span class="s2">"</span><span class="k">${</span><span class="nv">var</span><span class="p">.lambda_handler_name</span><span class="k">}</span><span class="s2">-</span><span class="k">${</span><span class="nv">var</span><span class="p">.stage</span><span class="k">}</span><span class="s2">"</span>
  default_env <span class="o">=</span> <span class="o">{</span>
    STAGE <span class="o">=</span> var.stage
  <span class="o">}</span>
  combined_env <span class="o">=</span> merge<span class="o">(</span>local.default_env, var.environment_variables<span class="o">)</span>
<span class="o">}</span>

<span class="c"># Terraform 사용시 Source code를 새롭게 build하도록 설정</span>
resource <span class="s2">"terraform_data"</span> <span class="s2">"build_app"</span> <span class="o">{</span>
  triggers_replace <span class="o">=</span> <span class="o">{</span>
    always_run <span class="o">=</span> timestamp<span class="o">()</span>
  <span class="o">}</span>
  provisioner <span class="s2">"local-exec"</span> <span class="o">{</span>
    <span class="nb">command</span> <span class="o">=</span> <span class="s2">"rm -rf </span><span class="k">${</span><span class="nv">local</span><span class="p">.esbuild_src</span><span class="k">}</span><span class="s2"> &amp;&amp; export PATH=</span><span class="nv">$PATH</span><span class="s2">:</span><span class="k">${</span><span class="nv">path</span><span class="p">.cwd</span><span class="k">}</span><span class="s2">/node_modules/.bin &amp;&amp; npm run build:prod"</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="c"># AWS SAM을 위한 metadata 생성</span>
resource <span class="s2">"null_resource"</span> <span class="s2">"sam_metadata_aws_lambda_function"</span> <span class="o">{</span>
  count <span class="o">=</span> 1

  provisioner <span class="s2">"local-exec"</span> <span class="o">{</span>
    <span class="nb">command</span> <span class="o">=</span> <span class="s2">"rm -rf </span><span class="k">${</span><span class="nv">local</span><span class="p">.esbuild_src</span><span class="k">}</span><span class="s2"> &amp;&amp; export PATH=</span><span class="nv">$PATH</span><span class="s2">:</span><span class="k">${</span><span class="nv">path</span><span class="p">.cwd</span><span class="k">}</span><span class="s2">/node_modules/.bin &amp;&amp; npm run build:prod"</span>
  <span class="o">}</span>

  triggers <span class="o">=</span> <span class="o">{</span>
    <span class="c"># This is a way to let SAM CLI correlates between the Lambda function resource, and this metadata</span>
    <span class="c"># resource</span>
    resource_name <span class="o">=</span> <span class="s2">"module.APIGatewayLambdaHandler.aws_lambda_function.this[0]"</span>
    resource_type <span class="o">=</span> <span class="s2">"ZIP_LAMBDA_FUNCTION"</span>

    <span class="c"># The Lambda function source code.</span>
    <span class="c"># original_source_code = jsonencode(var.source_path)</span>
    original_source_code <span class="o">=</span> local.esbuild_src

    <span class="c"># a property to let SAM CLI knows where to find the Lambda function source code if the provided</span>
    <span class="c"># value for original_source_code attribute is map.</span>
    <span class="c"># source_code_property = "path"</span>

    <span class="c"># A property to let SAM CLI knows where to find the Lambda function built output</span>
    built_output_path <span class="o">=</span> <span class="s2">"</span><span class="k">${</span><span class="nv">local</span><span class="p">.esbuild_src</span><span class="k">}</span><span class="s2">/</span><span class="k">${</span><span class="nv">module</span><span class="p">.APIGatewayLambdaHandler.local_filename == null ? </span><span class="s2">""</span><span class="p"> </span>:<span class="p"> module.APIGatewayLambdaHandler.local_filename == null</span><span class="k">}</span><span class="s2">"</span>
  <span class="o">}</span>

  <span class="c"># SAM CLI can run terraform apply -target metadata resource, and this will apply the building</span>
  <span class="c"># resources as well</span>
  depends_on <span class="o">=</span> <span class="o">[</span>terraform_data.build_app, module.APIGatewayLambdaHandler]
<span class="o">}</span>
</pre></table></code></div></div><h3 id="terraform에서-source-code에-대한-lambda-정의하기"><span class="me-2">Terraform에서 Source Code에 대한 Lambda 정의하기</span><a href="#terraform에서-source-code에-대한-lambda-정의하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Terraform으로 명시한 ‘Source Code Build’ 결과물을 ZIP파일로 만들고, Lambda로 명시합니다.</p><p><a href="https://github.com/KanghoonYi/terraform-aws-examples/blob/main/examples/lambda-base/apigateway/tfModules/APIGatewayHandler/main.tf">https://github.com/KanghoonYi/terraform-aws-examples/blob/main/examples/lambda-base/apigateway/tfModules/APIGatewayHandler/main.tf</a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
</pre><td class="rouge-code"><pre>module <span class="s2">"APIGatewayLambdaHandler"</span> <span class="o">{</span>
  <span class="nb">source</span>        <span class="o">=</span> <span class="s2">"terraform-aws-modules/lambda/aws"</span>
  architectures <span class="o">=</span> <span class="o">[</span><span class="s2">"arm64"</span><span class="o">]</span>
  <span class="nb">timeout</span>       <span class="o">=</span> 15

  function_name       <span class="o">=</span> local.function_name
  description         <span class="o">=</span> var.lambda_description
  handler             <span class="o">=</span> var.handler_src
  runtime             <span class="o">=</span> <span class="s2">"nodejs22.x"</span>
  memory_size         <span class="o">=</span> 256
  publish             <span class="o">=</span> <span class="nb">true
  </span>create_function     <span class="o">=</span> <span class="nb">true
  </span>create_package      <span class="o">=</span> <span class="nb">true
  </span>create_role         <span class="o">=</span> <span class="nb">false
  </span>create_sam_metadata <span class="o">=</span> <span class="nb">false</span> <span class="c"># 상위 과정에서 sam metadata를 수동으로 생성해야 하기 때문에, false로 세팅합니다</span>

  source_path <span class="o">=</span> <span class="o">[</span>
    <span class="o">{</span>
      path <span class="o">=</span> local.esbuild_src
      commands <span class="o">=</span> <span class="o">[</span>
        <span class="s2">"npm install --production"</span>,
        <span class="s2">":zip"</span> <span class="c"># AWS Lambda에 적용하기 위해, source code를 zip파일로 압축합니다.</span>
      <span class="o">]</span>,
      patterns : <span class="o">[</span>
        <span class="s2">"node_modules/.+"</span>,
        <span class="s2">"!node_modules/@aws-sdk/.*"</span>,
      <span class="o">]</span>
    <span class="o">}</span>
  <span class="o">]</span>

  store_on_s3 <span class="o">=</span> <span class="nb">true
  </span>s3_bucket   <span class="o">=</span> var.source_code_bucket_name

  environment_variables <span class="o">=</span> local.combined_env <span class="o">==</span> null ? <span class="o">{}</span> : local.combined_env

  lambda_role <span class="o">=</span> var.lambda_role_arn

  event_source_mapping <span class="o">=</span> <span class="o">{</span>
	  <span class="c"># SQS와 같이 Event mapping기능을 사용해야하는 경우에 여기에서 설정하게 됩니다.</span>
  <span class="o">}</span>

  tracing_mode          <span class="o">=</span> <span class="s2">"Active"</span>
  attach_network_policy <span class="o">=</span> <span class="nb">true
  </span>attach_tracing_policy <span class="o">=</span> <span class="nb">true

  </span>logging_log_group                 <span class="o">=</span> <span class="s2">"/aws/lambda/</span><span class="k">${</span><span class="nv">local</span><span class="p">.function_name</span><span class="k">}</span><span class="s2">"</span> <span class="c"># Cloudwatch에서 사용할 Log Group이름을 설정합니다</span>
  cloudwatch_logs_retention_in_days <span class="o">=</span> var.log_ttl_days

  depends_on <span class="o">=</span> <span class="o">[</span>
    terraform_data.build_app,
  <span class="o">]</span>
<span class="o">}</span>

<span class="c"># Proxy Resource (/{proxy+})</span>
resource <span class="s2">"aws_api_gateway_resource"</span> <span class="s2">"proxy"</span> <span class="o">{</span>
  rest_api_id <span class="o">=</span> var.agw_rest_api_id
  parent_id   <span class="o">=</span> var.agw_parent_resource_id
  path_part   <span class="o">=</span> var.agw_http_path
<span class="o">}</span>

<span class="c"># Method (ANY)</span>
resource <span class="s2">"aws_api_gateway_method"</span> <span class="s2">"proxy_method"</span> <span class="o">{</span>
  rest_api_id   <span class="o">=</span> var.agw_rest_api_id
  resource_id   <span class="o">=</span> aws_api_gateway_resource.proxy.id
  http_method   <span class="o">=</span> var.agw_http_method
  authorization <span class="o">=</span> <span class="s2">"NONE"</span>
<span class="o">}</span>

<span class="c"># Integration with Lambda</span>
resource <span class="s2">"aws_api_gateway_integration"</span> <span class="s2">"lambda"</span> <span class="o">{</span>
  rest_api_id             <span class="o">=</span> var.agw_rest_api_id
  resource_id             <span class="o">=</span> aws_api_gateway_resource.proxy.id
  http_method             <span class="o">=</span> aws_api_gateway_method.proxy_method.http_method
  integration_http_method <span class="o">=</span> <span class="s2">"POST"</span> <span class="c"># API Gateway에서 Lambda를 실행할때 사용하는 method입니다. Lambda를 Invoke하는 것은 'POST'로만 가능합니다.</span>
  <span class="nb">type</span>                    <span class="o">=</span> <span class="s2">"AWS_PROXY"</span>
  uri                     <span class="o">=</span> module.APIGatewayLambdaHandler.lambda_function_invoke_arn
<span class="o">}</span>

<span class="c"># Lambda Permission for API Gateway</span>
<span class="c"># API Gateway에서 Lambda를 실행할 수 있는 권한을 명시합니다.</span>
resource <span class="s2">"aws_lambda_permission"</span> <span class="s2">"apigw"</span> <span class="o">{</span>
  statement_id  <span class="o">=</span> <span class="s2">"AllowAPIGatewayInvoke"</span>
  action        <span class="o">=</span> <span class="s2">"lambda:InvokeFunction"</span>
  function_name <span class="o">=</span> module.APIGatewayLambdaHandler.lambda_function_name
  principal     <span class="o">=</span> <span class="s2">"apigateway.amazonaws.com"</span>
  source_arn    <span class="o">=</span> <span class="s2">"</span><span class="k">${</span><span class="nv">var</span><span class="p">.agw_execution_arn</span><span class="k">}</span><span class="s2">/*/*"</span>
<span class="o">}</span>
</pre></table></code></div></div><h3 id="local-에서-http-server-실행-방법"><span class="me-2">Local 에서 HTTP Server 실행 방법</span><a href="#local-에서-http-server-실행-방법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>이제 AWS SAM을 이용해서, Terraform환경의 세팅을 기반으로 HTTP server를 실행해 보겠습니다.</p><blockquote class="prompt-info"><p>AWS SAM은 Docker기반으로 실행됩니다. 때문에, Docker Daemon이 실행중이어야 합니다.</p></blockquote><blockquote class="prompt-info"><p>AWS SAM은 AWS CLI를 기반으로 작동하기 때문에, AWS Token관련 환경변수가 설정되어 있어야 합니다.</p></blockquote><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="err">#</span><span class="w"> </span><span class="err">examples/lambda-base/apigateway/package.json</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"apigateway"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"module"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"build:dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NODE_ENV=dev tsx esbuild.ts &amp;&amp; (cd .esbuild &amp;&amp; npm install --omit=dev)"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"build:prod"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NODE_ENV=production tsx esbuild.ts &amp;&amp; (cd .esbuild &amp;&amp; npm install --omit=dev)"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"local-run:dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sam local start-api --hook-name terraform --beta-features"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"devDependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>위의 <code class="language-plaintext highlighter-rouge">package.json</code> 내용중, 아래와 같은 실행 명령어를 사용합니다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$ NODE_ENV</span><span class="o">=</span>dev tsx esbuild.ts <span class="o">&amp;&amp;</span> <span class="o">(</span><span class="nb">cd</span> .esbuild <span class="o">&amp;&amp;</span> npm <span class="nb">install</span> <span class="nt">--omit</span><span class="o">=</span>dev<span class="o">)</span> <span class="c">## 혹은 npm run buidl:dev</span>
<span class="nv">$ </span>sam <span class="nb">local </span>start-api <span class="nt">--hook-name</span> terraform <span class="nt">--beta-features</span> 
</pre></table></code></div></div><p>그러면, 아래와 같은 메세지가 뜹니다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Experimental features are enabled <span class="k">for </span>this session.                                                                                                                                         
Visit the docs page to learn more about the AWS Beta terms https://aws.amazon.com/service-terms/.                                                                                           
                                                                                                                                                                                            
Mounting APIGatewayGetHello-dev at http://127.0.0.1:3000/hello <span class="o">[</span>GET]                                                                                                                        
You can now browse to the above endpoints to invoke your functions. You <span class="k">do </span>not need to restart/reload SAM CLI <span class="k">while </span>working on your functions, changes will be reflected                    
instantly/automatically. If you used sam build before running <span class="nb">local </span>commands, you will need to re-run sam build <span class="k">for </span>the changes to be picked up. You only need to restart SAM CLI <span class="k">if </span>you    
update your AWS SAM template                                                                                                                                                                
2025-04-03 20:57:59 WARNING: This is a development server. Do not use it <span class="k">in </span>a production deployment. Use a production WSGI server instead.
 <span class="k">*</span> Running on http://127.0.0.1:3000
2025-04-03 20:57:59 Press CTRL+C to quit

</pre></table></code></div></div><p>여기서 <code class="language-plaintext highlighter-rouge">http://127.0.0.1:3000/hello [GET]</code> 부분을 확인할 수 있습니다.<br /> 이제 이 URL을 통해 HTTP 요청을 보내서 Application을 테스트해 볼 수 있습니다.</p><h3 id="source-code-배포-방법"><span class="me-2">Source Code 배포 방법</span><a href="#source-code-배포-방법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Source Code를 배포할 때는, terraform을 적용할때와 같습니다.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$ </span>terraform apply <span class="nt">-var-file</span><span class="o">=</span>./vars/dev.tfvars
</pre></table></code></div></div><h2 id="한계"><span class="me-2">한계</span><a href="#한계" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>이런식으로 Terraform환경에서도 Serverless Architecture를 구현할 수 있지만, Local구동시에도 Docker와 같은 각종 의존성이 생기는 문제가 있습니다.<br /> 또한 이로 인해(Docker기반으로 Local서버가 실행되어서), Debugger를 이용해서 Application을 debuging하는 환경은 아직 세팅되어 있지 않습니다.</p><h2 id="references"><span class="me-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><dl><dt>Terraform Module 구조<dd><a href="https://developer.hashicorp.com/terraform/language/modules/develop/structure">Standard Module Structure | Terraform | HashiCorp Developer</a><dt>Terraform에서 사용하는 AWS Spec 확인하기<dd><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs">Terraform Registry</a><dt>terraform-aws-module과 AWS SAM 연동<dd><a href="https://registry.terraform.io/modules/terraform-aws-modules/lambda/aws/latest#sam_cli_integration">Terraform Registry</a><dd><a href="https://aws.amazon.com/ko/blogs/compute/better-together-aws-sam-cli-and-hashicorp-terraform/">Better together: AWS SAM CLI and HashiCorp Terraform | Amazon Web Services</a><dt>Terraform관련 AWS 공식 문서<dd><a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/terraform-support.html">AWS SAM CLI Terraform support - AWS Serverless Application Model</a><dt>AWS SAM을 이용해서 local에서 test하기<dd><a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/using-samcli-terraform.html">Using the AWS SAM CLI with Terraform for local debugging and testing - AWS Serverless Application Model</a></dl></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/devops/">DevOps</a>, <a href="/categories/terraform/">Terraform</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/aws/" class="post-tag no-text-decoration" >aws</a> <a href="/tags/terraform/" class="post-tag no-text-decoration" >terraform</a> <a href="/tags/serverless/" class="post-tag no-text-decoration" >serverless</a> <a href="/tags/iac/" class="post-tag no-text-decoration" >iac</a> <a href="/tags/lambda/" class="post-tag no-text-decoration" >lambda</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Serverless%20Architecture%20with%20Terraform%20-%20REST%20API%20-%20KanghoonYi(Pour)&url=https%3A%2F%2Fblog.devpour.net%2Fposts%2FServerless-Architecture-with-Terraform-REST-API%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Serverless%20Architecture%20with%20Terraform%20-%20REST%20API%20-%20KanghoonYi(Pour)&u=https%3A%2F%2Fblog.devpour.net%2Fposts%2FServerless-Architecture-with-Terraform-REST-API%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fblog.devpour.net%2Fposts%2FServerless-Architecture-with-Terraform-REST-API%2F&text=Serverless%20Architecture%20with%20Terraform%20-%20REST%20API%20-%20KanghoonYi(Pour)" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/k8s-gpu-1/">kubernetes 환경에서 GPU 서빙 | GPU인식</a><li class="text-truncate lh-lg"> <a href="/posts/Redis/">Redis | Key Technologies - System Design Interview</a><li class="text-truncate lh-lg"> <a href="/posts/Consistent-Hashing/">Consistent Hashing | Core Concepts - System Design Interview</a><li class="text-truncate lh-lg"> <a href="/posts/k8s-introduction/">Kubernetes(Orchestration) 개론</a><li class="text-truncate lh-lg"> <a href="/posts/CAP-Theorem/">CAP Theorem(정리) | Core Concepts - System Design Interview</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/leetcode/">leetcode</a> <a class="post-tag btn btn-outline-primary" href="/tags/rust/">rust</a> <a class="post-tag btn btn-outline-primary" href="/tags/computer-science/">Computer Science</a> <a class="post-tag btn btn-outline-primary" href="/tags/cncf/">cncf</a> <a class="post-tag btn btn-outline-primary" href="/tags/k8s/">k8s</a> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a> <a class="post-tag btn btn-outline-primary" href="/tags/architecture/">Architecture</a></div></section></div><section id="toc-wrapper" class="d-none ps-0 pe-4"><h2 class="panel-heading ps-3 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/Understand-Terraform-state/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1743862320" data-df="ll" > Apr 5, 2025 </time><h4 class="pt-0 my-2">Terraform의 State와 Flow 이해하기</h4><div class="text-muted"><p>들어가면서 이 post에선, Terraform의 핵심인 ‘State’에 대해서 알아봅니다. 본문 Terraform의 State에 대한 이해 Terraform은 리소스의 현재 상태를 저장하고 추적하기 위해 State 파일을 사용합니다. State 파일에는 Terraform이 관리하는 인프라 리소스의 실제 상태가 JSON 형태로 저장됩니다. ...</p></div></div></a></article><article class="col"> <a href="/posts/Running-Puppeteer-on-AWS-Lambda/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1644062100" data-df="ll" > Feb 5, 2022 </time><h4 class="pt-0 my-2">Running Puppeteer on AWS Lambda</h4><div class="text-muted"><p>What is Puppeteer? Puppeteer is a Node library which provides a high-level API to control Chrome or Chromium over the DevTools Protocol. Puppeteer runs headless by default, but can be configured...</p></div></div></a></article><article class="col"> <a href="/posts/What-is-RFC-1918/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1750746780" data-df="ll" > Jun 24, 2025 </time><h4 class="pt-0 my-2">What is 'RFC 1918' about 'Private IP'?</h4><div class="text-muted"><p>IPv4는 전세계 네트워크의 근간입니다. 하지만, 이 IPv4의 데이터 대역은, 다른 데이터(int등)와 같이, 표현하기 위한 데이터 ‘갯수’에 제한이 있습니다. Private IP(사설 IP)의 필요성 이 제한을 극복하기 위해, ‘Private IP’개념을 사용하게 됩니다. ‘Private IP’는 사설망(Private Network, 내부망이라...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/What-is-AWS-Nitro-System/" class="btn btn-outline-primary" aria-label="Older" ><p>What is “AWS Nitro System”?</p></a> <a href="/posts/Understand-Terraform-state/" class="btn btn-outline-primary" aria-label="Newer" ><p>Terraform의 State와 Flow 이해하기</p></a></nav><script src="https://utteranc.es/client.js" repo="KanghoonYi/kanghoonyi.github.io" issue-term="pathname" crossorigin="anonymous" async ></script> <script type="text/javascript"> (function () { const origin = 'https://utteranc.es'; const lightTheme = 'github-light'; const darkTheme = 'github-dark'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } addEventListener('message', (event) => { let theme;if (event.origin === origin) {theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) {const mode = event.data.message; theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; } else { return; } const message = { type: 'set-theme', theme: theme }; const utterances = document.getElementsByClassName('utterances-frame')[0].contentWindow; utterances.postMessage(message, origin); }); })(); </script><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>© <time>2026</time> <a href="https://github.com/KanghoonYi">KanghoonYi</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.1.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/programming/">programming</a> <a class="post-tag btn btn-outline-primary" href="/tags/aws/">aws</a> <a class="post-tag btn btn-outline-primary" href="/tags/leetcode/">leetcode</a> <a class="post-tag btn btn-outline-primary" href="/tags/rust/">rust</a> <a class="post-tag btn btn-outline-primary" href="/tags/computer-science/">Computer Science</a> <a class="post-tag btn btn-outline-primary" href="/tags/cncf/">cncf</a> <a class="post-tag btn btn-outline-primary" href="/tags/k8s/">k8s</a> <a class="post-tag btn btn-outline-primary" href="/tags/kubernetes/">kubernetes</a> <a class="post-tag btn btn-outline-primary" href="/tags/algorithm/">algorithm</a> <a class="post-tag btn btn-outline-primary" href="/tags/architecture/">Architecture</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script> <script src="/assets/js/dist/post.min.js"></script> <script>SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
